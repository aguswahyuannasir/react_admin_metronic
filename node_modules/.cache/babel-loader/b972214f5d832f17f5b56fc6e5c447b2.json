{"ast":null,"code":"/* Javascript plotting library for jQuery, version 0.8.3.\n\nCopyright (c) 2007-2014 IOLA and Ole Laursen.\nLicensed under the MIT license.\n\n*/\n(function ($) {\n  var options = {\n    series: {\n      stack: null\n    }\n  };\n\n  function init(plot) {\n    function findMatchingSeries(s, allseries) {\n      var res = null;\n\n      for (var i = 0; i < allseries.length; ++i) {\n        if (s == allseries[i]) break;\n        if (allseries[i].stack == s.stack) res = allseries[i];\n      }\n\n      return res;\n    }\n\n    function stackData(plot, s, datapoints) {\n      if (s.stack == null || s.stack === false) return;\n      var other = findMatchingSeries(s, plot.getData());\n      if (!other) return;\n      var ps = datapoints.pointsize,\n          points = datapoints.points,\n          otherps = other.datapoints.pointsize,\n          otherpoints = other.datapoints.points,\n          newpoints = [],\n          px,\n          py,\n          intery,\n          qx,\n          qy,\n          bottom,\n          withlines = s.lines.show,\n          horizontal = s.bars.horizontal,\n          withbottom = ps > 2 && (horizontal ? datapoints.format[2].x : datapoints.format[2].y),\n          withsteps = withlines && s.lines.steps,\n          fromgap = true,\n          keyOffset = horizontal ? 1 : 0,\n          accumulateOffset = horizontal ? 0 : 1,\n          i = 0,\n          j = 0,\n          l,\n          m;\n\n      while (true) {\n        if (i >= points.length) break;\n        l = newpoints.length;\n\n        if (points[i] == null) {\n          for (m = 0; m < ps; ++m) newpoints.push(points[i + m]);\n\n          i += ps;\n        } else if (j >= otherpoints.length) {\n          if (!withlines) {\n            for (m = 0; m < ps; ++m) newpoints.push(points[i + m]);\n          }\n\n          i += ps;\n        } else if (otherpoints[j] == null) {\n          for (m = 0; m < ps; ++m) newpoints.push(null);\n\n          fromgap = true;\n          j += otherps;\n        } else {\n          px = points[i + keyOffset];\n          py = points[i + accumulateOffset];\n          qx = otherpoints[j + keyOffset];\n          qy = otherpoints[j + accumulateOffset];\n          bottom = 0;\n\n          if (px == qx) {\n            for (m = 0; m < ps; ++m) newpoints.push(points[i + m]);\n\n            newpoints[l + accumulateOffset] += qy;\n            bottom = qy;\n            i += ps;\n            j += otherps;\n          } else if (px > qx) {\n            if (withlines && i > 0 && points[i - ps] != null) {\n              intery = py + (points[i - ps + accumulateOffset] - py) * (qx - px) / (points[i - ps + keyOffset] - px);\n              newpoints.push(qx);\n              newpoints.push(intery + qy);\n\n              for (m = 2; m < ps; ++m) newpoints.push(points[i + m]);\n\n              bottom = qy;\n            }\n\n            j += otherps;\n          } else {\n            if (fromgap && withlines) {\n              i += ps;\n              continue;\n            }\n\n            for (m = 0; m < ps; ++m) newpoints.push(points[i + m]);\n\n            if (withlines && j > 0 && otherpoints[j - otherps] != null) bottom = qy + (otherpoints[j - otherps + accumulateOffset] - qy) * (px - qx) / (otherpoints[j - otherps + keyOffset] - qx);\n            newpoints[l + accumulateOffset] += bottom;\n            i += ps;\n          }\n\n          fromgap = false;\n          if (l != newpoints.length && withbottom) newpoints[l + 2] += bottom;\n        }\n\n        if (withsteps && l != newpoints.length && l > 0 && newpoints[l] != null && newpoints[l] != newpoints[l - ps] && newpoints[l + 1] != newpoints[l - ps + 1]) {\n          for (m = 0; m < ps; ++m) newpoints[l + ps + m] = newpoints[l + m];\n\n          newpoints[l + 1] = newpoints[l - ps + 1];\n        }\n      }\n\n      datapoints.points = newpoints;\n    }\n\n    plot.hooks.processDatapoints.push(stackData);\n  }\n\n  $.plot.plugins.push({\n    init: init,\n    options: options,\n    name: \"stack\",\n    version: \"1.2\"\n  });\n})(jQuery);","map":null,"metadata":{},"sourceType":"script"}